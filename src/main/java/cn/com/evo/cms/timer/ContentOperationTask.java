package cn.com.evo.cms.timer;import cn.com.evo.admin.manage.domain.entity.Province;import cn.com.evo.admin.manage.service.ProvinceService;import cn.com.evo.cms.domain.entity.total.ContentOperation;import cn.com.evo.cms.service.total.ContentOperationService;import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.Logger;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Component;import java.util.List;/** * @Description: 内容注入简单定时器 * @author: lu.xin * @create: 2019-05-16 11:08 AM **/@Componentpublic class ContentOperationTask {    protected Logger logger = LogManager.getLogger(this.getClass());    @Autowired    private ContentOperationService contentOperationService;    @Autowired    private ProvinceService provinceService;    private static boolean isRun = false;    /**     * 每5分钟执行一次     *///    @Scheduled(cron = "0 0/5 * * * ?")//    @PostConstruct    public void run() {        if (!isRun) {            logger.error("内容注入定时器启动。");            logger.error("每5分钟自动扫描注入失败的内容，重新注入");            isRun = true;        }        Province province = provinceService.getByEnable(1);        if (province == null) {            throw new RuntimeException("找不到可用的省网配置");        }        // 获取注入失败的内容注入列表        List<ContentOperation> list = contentOperationService.findByStatus(3);        for (ContentOperation contentOperation : list) {            contentOperationService.send(contentOperation.getId(), province);        }    }}