package cn.com.evo.integration.scyd.content.xml;import cn.com.evo.integration.common.enums.ActionEnum;import cn.com.evo.integration.common.utils.BeanToXml;import cn.com.evo.integration.scyd.content.xml.enums.ElementTypeEnum;import cn.com.evo.integration.scyd.content.xml.model.*;import cn.com.evo.integration.scyd.content.xml.model.Object;import com.google.common.collect.Lists;import javax.xml.bind.JAXBException;import java.util.List;/** * @Description: 创建内容类xml * @author: lu.xin * @create: 2019-03-05 4:06 PM **/public class CreateXML {    /**     * 创建xml     *     * @param contentDto 内容对象     * @param action     动作  REGIST  UPDATE  DELETE     * @return     * @throws JAXBException     */    public static String create(ContentDto contentDto,                                String action) throws JAXBException {        // 对象列表        List<Object> objects = Lists.newArrayList();        // mapping列表        List<Mapping> mappings = Lists.newArrayList();        // 创建剧集对象        Object series = Object.createSeriesObject(contentDto.getContent(), contentDto.getPictureUrls(), action);        // 加入对象列表        objects.add(series);        for (ChildContentDto child : contentDto.getChildren()) {            // 子集当前集数            Integer childNum = child.getChildContent().getSort();            // 创建节目对象            Object program = Object.createProgramObject(contentDto.getContent(), child.getChildContent(), contentDto.getPictureUrls(), childNum, action);            // 创建媒体对象            Object movie = Object.createMovieObject(contentDto.getContent(), child.getVideo(), action);            //创建剧集与节目对象mapping            Mapping spMapping = new Mapping(action, ElementTypeEnum.Series.getValue(), series.getId(), series.getCode(),                    ElementTypeEnum.Program.getValue(), program.getId(), program.getCode());            //创建节目与媒体对象mapping            Mapping pmMapping = new Mapping(action, ElementTypeEnum.Program.getValue(), program.getId(), program.getCode(),                    ElementTypeEnum.Movie.getValue(), movie.getId(), movie.getCode());            //节目对象加入对象列表            objects.add(program);            if (!ActionEnum.DELETE.getValue().equals(action)) {                //媒体对象加入对象列表                objects.add(movie);                // 非删除时，加入mapping对象                //剧集与节目对象mapping加入mapping列表                mappings.add(spMapping);                //节目与媒体对象mapping加入mapping列表                mappings.add(pmMapping);            } else {                // 删除时不创建媒体对象。不创建mapping对象            }        }        Objects objects1 = new Objects(objects);        Mappings mappings1 = new Mappings(mappings);        ADI adi = new ADI(objects1, mappings1);        String xmlStr = BeanToXml.beanToXml(adi, false);        return xmlStr;    }}